#!@PYTHON@

import top
import sys

if __name__ == '__main__':
    poly = top.load('eq_poly_ester')
    poly.read_dati('@builddir@/dati')
    poly.set_nt(20)
    poly.dati.nsol = 1
    poly.init_model('@builddir@/model/')
    res = poly.run_arncheb(poly.dati.shift)

    f, v, l = res.get_sol(0, 0, 'Phi')
    print('Expected freq: %e, Computed freq = %e' % (poly.dati.shift, f))
    if abs(f - poly.dati.shift) > 1e-9:
        print('Error: Unexpected frequency (error=%e)' % abs(f - poly.dati.shift))
        sys.exit(1)
